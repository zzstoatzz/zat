when:
  - event: push
    tag: "v*"
  - event: push
    branch: main
    path:
      - "README.md"
      - "CHANGELOG.md"
      - "docs/**"
      - "devlog/**"

engine: nixery

dependencies:
  nixpkgs:
    - zig

steps:
  - name: build and publish docs to ATProto
    command: |
      test -n "$ATPROTO_PASSWORD"
      zig build
      ./zig-out/bin/publish-docs
